conda update conda 
conda install -c rdkit rdkit -y 
import pandas as pd
df = pd.read_csv('bioactivity_data_preprocessed.csv')

# calculate Lipinski descriptors
# these evaluate the druglikeness of compounds
# Such druglikeness is based on the Absorption, Distribution, Metabolism and Excretion (ADME) that is also known as the pharmacokinetic profile.
# The Lipinski's Rule stated the following:
#Molecular weight < 500 Dalton
#Octanol-water partition coefficient (LogP) < 5
#Hydrogen bond donors < 5
#Hydrogen bond acceptors < 10

import numpy as np
from rdkit import Chem
from rdkit.Chem import Descriptors, Lipinski

#calculate descriptors 
def lipinski(smiles, verbose=False):

    moldata= []
    for elem in smiles:
        mol=Chem.MolFromSmiles(elem) 
        moldata.append(mol)
       
    baseData= np.arange(1,1)
    i=0  
    for mol in moldata:        
       
        desc_MolWt = Descriptors.MolWt(mol)
        desc_MolLogP = Descriptors.MolLogP(mol)
        desc_NumHDonors = Lipinski.NumHDonors(mol)
        desc_NumHAcceptors = Lipinski.NumHAcceptors(mol)
           
        row = np.array([desc_MolWt,
                        desc_MolLogP,
                        desc_NumHDonors,
                        desc_NumHAcceptors])   
    
        if(i==0):
            baseData=row
        else:
            baseData=np.vstack([baseData, row])
        i=i+1      
    
    columnNames=["MW","LogP","NumHDonors","NumHAcceptors"]   
    descriptors = pd.DataFrame(data=baseData,columns=columnNames)
    
    return descriptors

df_lipinski = lipinski(df_clean_smiles.canonical_smiles)

#combine df and df_lipinski
df_combined = pd.concat([df,df_lipinski], axis=1)

# Convert IC50 to pIC50
# this is the -log

#select active and inactive bioactivity classes 
